!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("AcurastExample",[],t):"object"==typeof exports?exports.AcurastExample=t():e.AcurastExample=t()}(self,(()=>(()=>{var e,t={3115:function(e,t,n){"use strict";var o=n(8287).hp,r=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getSenderId=t.generateKey=void 0,t.generateKey=()=>r(void 0,void 0,void 0,(function*(){const e=yield window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign"]),[t,n]=yield Promise.all([window.crypto.subtle.exportKey("jwk",e.privateKey).then((e=>new Uint8Array(o.from(e.d,"base64")))),window.crypto.subtle.exportKey("raw",e.publicKey).then((e=>new Uint8Array(e)))]);return{privateKeyRaw:t,publicKeyRaw:n}})),t.getSenderId=e=>r(void 0,void 0,void 0,(function*(){const t=new Uint8Array(o.from(e.substring(2),"hex")),n=yield window.crypto.subtle.digest("SHA-256",t);return o.from(n.slice(0,16)).toString("hex")}))},8986:function(e,t,n){"use strict";var o,r,s=n(8287).hp,i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((o=o.apply(e,t||[])).next())}))},c=this&&this.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const a=n(2218),l=n(3115);let d=null;const u="acurast_websocket_urls",p="acurast_recipients",y="acurast_payload",m="acurast_api_key",g=[],f=[{name:"Test",processorAddress:"5000000000000000000000000000000000000000000000000000000000000000",isGateKeeper:!0,pubkey:"0x0000000000000000000000000000000000000000000000000000000000000000"}],v={jsonrpc:"2.0",method:"ping",params:{}};function b(){try{const e=JSON.parse(localStorage.getItem(u)||JSON.stringify(g)),t=JSON.parse(localStorage.getItem(p)||JSON.stringify(f)),n=JSON.parse(localStorage.getItem(y)||JSON.stringify(v)),{id:o,apiKey:r}=n;return{urls:e,recipients:t,payload:c(n,["id","apiKey"])}}catch(e){return{urls:g,recipients:f,payload:v}}}function h(){const{urls:e,recipients:t,payload:n}=b();document.getElementById("websocket-urls-list").innerHTML=e.map((e=>`<li>${e}</li>`)).join(""),document.getElementById("recipients-list").innerHTML=t.map((e=>`\n    <li>\n      <label>\n        <input type="checkbox" class="recipient-checkbox" data-pubkey="${e.pubkey}" checked>\n        ${e.name}\n      </label>\n    </li>\n  `)).join("");const o=document.getElementById("select-all-recipients"),r=document.querySelectorAll(".recipient-checkbox[data-pubkey]");o.addEventListener("change",(()=>{r.forEach((e=>{e.checked=o.checked}))})),r.forEach((e=>{e.addEventListener("change",(()=>{const e=Array.from(r).every((e=>e.checked));o.checked=e}))}));const s=document.getElementById("request-payload"),{id:i,apiKey:a}=n,l=c(n,["id","apiKey"]);s.value=JSON.stringify(l,null,2)}function k(){const{recipients:e}=b(),t=new Set(Array.from(document.querySelectorAll(".recipient-checkbox[data-pubkey]:checked")).map((e=>e.dataset.pubkey)));return e.filter((e=>t.has(e.pubkey)))}function E(){return i(this,void 0,void 0,(function*(){const{urls:e}=b(),{privateKeyRaw:t,publicKeyRaw:n}=yield(0,l.generateKey)();return d=new a.AcurastClient(e),yield d.start({secretKey:s.from(t).toString("hex"),publicKey:s.from(n).toString("hex")}),d}))}function S(e,t="pending"){const n=document.getElementById("results-container");let o=document.getElementById(`result-${e.pubkey}`);return o||(o=document.createElement("div"),o.id=`result-${e.pubkey}`,o.innerHTML=`\n      <h4>${e.name} ${e.isGateKeeper?"üîê":""}</h4>\n      <div class="content"></div>\n    `,n.appendChild(o)),o.className=`result-box ${t}`,o.querySelector(".content")}function O(e,t){const n=(new Date).toISOString();console.log(`[${n}] ${"outgoing"===e?"‚Üí":"‚Üê"} ${JSON.stringify(t,null,2)}`)}function w(){const e=document.querySelector(".loading-indicator");null==e||e.classList.add("active")}function I(){const e=document.querySelector(".loading-indicator");null==e||e.classList.remove("active")}function x(){return i(this,void 0,void 0,(function*(){const e=localStorage.getItem(m);if(!e)return;const t=k();if(0===t.length)return void alert("Please select at least one recipient");w();const n=document.getElementById("results-container"),o=document.getElementById("ping-results");o.querySelector("tbody"),n.style.display="none",o.style.display="table";const r=new Map,i=new Map;t.forEach((e=>{r.set(e.pubkey,{recipient:e,responseTime:0,status:"timeout",version:"pending..."})})),j(r);const c=new Map;try{d=yield E(),d.onMessage((e=>{var n;const o=s.from(e.payload).toString("utf8");try{const e=JSON.parse(o);O("incoming",e);const s=i.get(e.id),a=s?t.find((e=>e.pubkey===s)):null;if(a){const t=c.get(a.pubkey)||0,o=Date.now()-t;r.set(a.pubkey,{recipient:a,responseTime:o,version:null===(n=e.result)||void 0===n?void 0:n.version,status:"success"}),j(r)}}catch(e){console.error("Failed to parse message:",e)}}));for(const n of t){c.set(n.pubkey,Date.now());const t=Math.random().toString(36).substring(2,15);i.set(t,n.pubkey);const o={jsonrpc:"2.0",method:"ping",params:{},id:t,apiKey:e};O("outgoing",Object.assign(Object.assign({},o),{recipient:n.name}));try{yield d.send(n.pubkey.substring(2),s.from(JSON.stringify(o)).toString("hex"))}catch(e){r.set(n.pubkey,{recipient:n,responseTime:0,status:"timeout"}),j(r)}}setTimeout((()=>{for(const e of t){const t=r.get(e.pubkey);"success"!==(null==t?void 0:t.status)&&r.set(e.pubkey,{recipient:e,responseTime:0,status:"timeout"})}j(r),I()}),1e4)}catch(e){console.error("Error during ping:",e),o.style.display="none",n.style.display="block",n.innerHTML=`<div class="result-box error"><div class="content">Error: ${e instanceof Error?e.message:String(e)}</div></div>`,I()}}))}function j(e){const t=document.querySelector("#ping-results tbody"),n=Array.from(e.values()).sort(((e,t)=>"success"===e.status&&"success"!==t.status?-1:"success"!==e.status&&"success"===t.status||"timeout"===e.status&&"timeout"!==t.status?1:"timeout"!==e.status&&"timeout"===t.status?-1:e.responseTime-t.responseTime));t.innerHTML=n.map((e=>`\n    <tr class="${"timeout"===e.status?"timeout":""}">\n      <td>${"success"===e.status?"‚úÖ":"pending..."===e.version?"‚è≥":"‚ùå"} ${e.recipient.isGateKeeper?"üîê":""}</td>\n      <td>${"success"===e.status?`${e.responseTime}ms`:"pending..."===e.version?"waiting...":"timeout"}</td>\n      <td>${e.version||"-"}</td>\n      <td>${e.recipient.name}</td>\n    </tr>\n  `)).join("")}document.addEventListener("DOMContentLoaded",(()=>{var e,t;h(),function(){var e,t,n,o;const{urls:r,recipients:s}=b(),i=document.getElementById("urls-modal"),c=document.getElementById("urls-input");null===(e=document.getElementById("set-urls-btn"))||void 0===e||e.addEventListener("click",(()=>{c.value=JSON.stringify(r,null,2),i.showModal()})),null===(t=document.getElementById("urls-save"))||void 0===t||t.addEventListener("click",(()=>{try{const e=JSON.parse(c.value);if(!Array.isArray(e)||!e.every((e=>"string"==typeof e)))throw new Error("Invalid URLs format");localStorage.setItem(u,JSON.stringify(e)),h(),i.close()}catch(e){alert("Invalid JSON format for URLs")}}));const a=document.getElementById("recipients-modal"),l=document.getElementById("recipients-input");null===(n=document.getElementById("set-recipients-btn"))||void 0===n||n.addEventListener("click",(()=>{l.value=JSON.stringify(s,null,2),a.showModal()})),null===(o=document.getElementById("recipients-save"))||void 0===o||o.addEventListener("click",(()=>{try{const e=JSON.parse(l.value);if(!Array.isArray(e)||!e.every((e=>"object"==typeof e&&e.name&&e.pubkey&&"string"==typeof e.pubkey)))throw new Error("Invalid recipients format");localStorage.setItem(p,JSON.stringify(e)),h(),a.close()}catch(e){alert("Invalid JSON format for recipients")}}))}(),function(){const e=document.getElementById("request-payload");let t=null;e.addEventListener("input",(()=>{t&&window.clearTimeout(t),t=window.setTimeout((()=>{try{const t=JSON.parse(e.value);if("ping"!==t.method&&"checkNodes"!==t.method){const{id:e,apiKey:n}=t,o=c(t,["id","apiKey"]);localStorage.setItem(y,JSON.stringify(o))}}catch(e){}}),500)}))}(),function(){var e;const t=document.getElementById("api-key"),n=(document.getElementById("api-key-status"),t.closest(".input-with-status")),o=document.getElementById("api-key-set"),r=[document.getElementById("send-ping-btn"),document.getElementById("send-node-check-btn"),document.getElementById("send-get-info-btn"),document.getElementById("connect-btn")];function s(e){n.style.display=e?"none":"flex",o.style.display=e?"block":"none",e?r.forEach((e=>null==e?void 0:e.removeAttribute("disabled"))):r.forEach((e=>null==e?void 0:e.setAttribute("disabled","true")))}const i=localStorage.getItem(m);i?(t.value=i,s(!0)):s(!1),t.addEventListener("input",(()=>{const e=t.value.trim();e&&(localStorage.setItem(m,e),s(!0))})),null===(e=document.getElementById("delete-api-key"))||void 0===e||e.addEventListener("click",(()=>{localStorage.removeItem(m),t.value="",s(!1)}))}(),null===(e=document.getElementById("send-ping-btn"))||void 0===e||e.addEventListener("click",x),null===(t=document.getElementById("send-node-check-btn"))||void 0===t||t.addEventListener("click",(()=>{var e;document.getElementById("request-payload").value=JSON.stringify({jsonrpc:"2.0",method:"checkNodes",params:{}},null,2),null===(e=document.getElementById("connect-btn"))||void 0===e||e.click()}))})),null===(o=document.getElementById("connect-btn"))||void 0===o||o.addEventListener("click",(()=>i(void 0,void 0,void 0,(function*(){const e=localStorage.getItem(m);if(e)try{const t=k();if(0===t.length)return void alert("Please select at least one recipient");w();const n=document.getElementById("results-container"),o=document.getElementById("ping-results");n.style.display="block",o.style.display="none",n.innerHTML="",d=yield E();const r=JSON.parse(document.getElementById("request-payload").value);r.apiKey=e;const i=new Map,c=new Map,a=new Set;for(const e of t){const t=S(e);t.textContent="Connecting...\n",i.set(e.pubkey,(e=>{t.textContent+=e+"\n"}));const n=setTimeout((()=>{if(!a.has(e.pubkey)){const t=document.getElementById(`result-${e.pubkey}`);if(t){S(e,"error");const n=t.querySelector(".content");n&&(n.textContent="Timeout: No response received after 10 seconds\n")}}I()}),1e4);c.set(e.pubkey,n)}d.onMessage((e=>{const n=s.from(e.payload).toString("utf8");try{const e=JSON.parse(n);O("incoming",e);const o=t.find((t=>t.pubkey===e.id));if(o){a.add(o.pubkey);const n=c.get(o.pubkey);n&&(clearTimeout(n),c.delete(o.pubkey));const s=S(o,e.error?"error":"success");if(s.innerHTML="","checkNodes"===r.method&&!e.error){const t=function(e,t){var n,o;const r=document.createElement("div");r.className="node-check-result";const s=document.createElement("table");s.className="ping-results";let i=`\n    <tr>\n      <td colspan="2"><strong>${e.name} ${e.isGateKeeper?"üîê":""}</strong></td>\n    </tr>\n  `;if(null===(n=t.result)||void 0===n?void 0:n.data.responses[0]){i+='<tr><td colspan="2"><strong>BTC</strong></td></tr>';const e=t.result.data.responses[0];"fulfilled"===e.status&&e.value?e.value.responses.forEach((e=>{"fulfilled"===e.status&&e.value?i+=`<tr><td style="padding-left: 20px">‚úÖ</td><td>${e.value.url}</td></tr>`:"rejected"===e.status&&e.reason&&(i+=`<tr class="timeout"><td style="padding-left: 20px">‚ùå</td><td>${e.reason.url}: ${e.reason.reason}</td></tr>`)})):"rejected"===e.status&&(i+=`<tr class="timeout"><td colspan="2" style="padding-left: 20px">Error: ${e.reason}</td></tr>`)}if(null===(o=t.result)||void 0===o?void 0:o.data.responses[1]){i+='<tr><td colspan="2"><strong>XTZ</strong></td></tr>';const e=t.result.data.responses[1];"fulfilled"===e.status&&e.value?e.value.responses.forEach((e=>{"fulfilled"===e.status&&e.value?i+=`<tr><td style="padding-left: 20px">‚úÖ</td><td>${e.value.url}</td></tr>`:"rejected"===e.status&&e.reason&&(i+=`<tr class="timeout"><td style="padding-left: 20px">‚ùå</td><td>${e.reason.url}: ${e.reason.reason}</td></tr>`)})):"rejected"===e.status&&(i+=`<tr class="timeout"><td colspan="2" style="padding-left: 20px">Error: ${e.reason}</td></tr>`)}return s.innerHTML=i,r.appendChild(s),r}(o,e);s.appendChild(t)}const i=document.createElement("pre");i.style.marginTop="20px",i.textContent=JSON.stringify(e,null,2),s.appendChild(i),a.size===t.length&&I()}}catch(e){console.error("Failed to parse message:",e)}}));for(const e of t){const t=yield(0,l.getSenderId)(e.pubkey),n=i.get(e.pubkey);n&&n(`Sending request (${t})...`);const o=Object.assign(Object.assign({},r),{id:e.pubkey});O("outgoing",Object.assign(Object.assign({},o),{recipient:e.name}));try{yield d.send(e.pubkey.substring(2),s.from(JSON.stringify(o)).toString("hex"))}catch(t){a.add(e.pubkey);const n=c.get(e.pubkey);n&&(clearTimeout(n),c.delete(e.pubkey)),S(e,"error").textContent=`Error: ${t instanceof Error?t.message:String(t)}`,I()}}window.addEventListener("beforeunload",(()=>{for(const e of c.values())clearTimeout(e);I()}))}catch(e){const t=k();for(const n of t)S(n,"error").textContent=`Error: ${e instanceof Error?e.message:String(e)}`;I()}})))),null===(r=document.getElementById("send-get-info-btn"))||void 0===r||r.addEventListener("click",(function(){return i(this,void 0,void 0,(function*(){const e=localStorage.getItem(m);if(e){w();try{const t=k();if(0===t.length)return void alert("Please select at least one recipient");const n=document.getElementById("results-container"),o=document.getElementById("ping-results");n.style.display="block",o.style.display="none",n.innerHTML="",d=yield E();const r=new Map,i=new Map,c=new Set;for(const e of t){const t=S(e);t.textContent="Connecting...\n",r.set(e.pubkey,(e=>{t.textContent+=e+"\n"}));const n=setTimeout((()=>{if(!c.has(e.pubkey)){const t=document.getElementById(`result-${e.pubkey}`);if(t){S(e,"error");const n=t.querySelector(".content");n&&(n.textContent="Timeout: No response received after 10 seconds\n")}}I()}),1e4);i.set(e.pubkey,n)}d.onMessage((e=>{const n=s.from(e.payload).toString("utf8");try{const e=JSON.parse(n);O("incoming",e);const o=t.find((t=>t.pubkey===e.id));if(o){c.add(o.pubkey);const n=i.get(o.pubkey);n&&(clearTimeout(n),i.delete(o.pubkey));const r=S(o,e.error?"error":"success");r.innerHTML="";const s=document.createElement("pre");s.style.marginTop="20px",s.textContent=JSON.stringify(e,null,2),r.appendChild(s),c.size===t.length&&I()}}catch(e){console.error("Failed to parse message:",e)}}));for(const n of t){const t=yield(0,l.getSenderId)(n.pubkey),o=r.get(n.pubkey);o&&o(`Sending request (${t})...`);const a={jsonrpc:"2.0",method:"getXcbtcDeploymentInfo",params:{},id:n.pubkey,apiKey:e};O("outgoing",Object.assign(Object.assign({},a),{recipient:n.name}));try{yield d.send(n.pubkey.substring(2),s.from(JSON.stringify(a)).toString("hex"))}catch(e){c.add(n.pubkey);const t=i.get(n.pubkey);t&&(clearTimeout(t),i.delete(n.pubkey)),S(n,"error").textContent=`Error: ${e instanceof Error?e.message:String(e)}`,I()}}window.addEventListener("beforeunload",(()=>{for(const e of i.values())clearTimeout(e);I()}))}catch(e){const t=k();for(const n of t)S(n,"error").textContent=`Error: ${e instanceof Error?e.message:String(e)}`;I()}}}))}))},8156:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(8986),r(n(3115),t)},9432:()=>{},3776:()=>{},9368:()=>{}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.loaded=!0,s.exports}o.m=t,e=[],o.O=(t,n,r,s)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,r,s]=e[d],c=!0,a=0;a<n.length;a++)(!1&s||i>=s)&&Object.keys(o.O).every((e=>o.O[e](n[a])))?n.splice(a--,1):(c=!1,s<i&&(i=s));if(c){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,r,s]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,s,[i,c,a]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in c)o.o(c,r)&&(o.m[r]=c[r]);if(a)var d=a(o)}for(t&&t(n);l<i.length;l++)s=i[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},n=self.webpackChunkAcurastExample=self.webpackChunkAcurastExample||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[997,530,566,145],(()=>o(8156)));return o.O(r)})()));