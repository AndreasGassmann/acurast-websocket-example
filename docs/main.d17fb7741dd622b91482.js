!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("AcurastExample",[],t):"object"==typeof exports?exports.AcurastExample=t():e.AcurastExample=t()}(self,(()=>(()=>{var e,t={3115:function(e,t,n){"use strict";var r=n(8287).hp,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function c(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getSenderId=t.generateKey=void 0,t.generateKey=()=>o(void 0,void 0,void 0,(function*(){const e=yield window.crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign"]),[t,n]=yield Promise.all([window.crypto.subtle.exportKey("jwk",e.privateKey).then((e=>new Uint8Array(r.from(e.d,"base64")))),window.crypto.subtle.exportKey("raw",e.publicKey).then((e=>new Uint8Array(e)))]);return{privateKeyRaw:t,publicKeyRaw:n}})),t.getSenderId=e=>o(void 0,void 0,void 0,(function*(){const t=new Uint8Array(r.from(e.substring(2),"hex")),n=yield window.crypto.subtle.digest("SHA-256",t);return r.from(n.slice(0,16)).toString("hex")}))},8986:function(e,t,n){"use strict";var r,o=n(8287).hp,s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,s){function i(e){try{a(r.next(e))}catch(e){s(e)}}function c(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}a((r=r.apply(e,t||[])).next())}))},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const c=n(2218),a=n(3115);let l=null;const d="acurast_websocket_urls",u="acurast_recipients",p="acurast_payload",y="acurast_api_key",m=[],f=[{name:"Test",processorAddress:"5000000000000000000000000000000000000000000000000000000000000000",isGateKeeper:!0,pubkey:"0x0000000000000000000000000000000000000000000000000000000000000000"}],g={jsonrpc:"2.0",method:"ping",params:{}};function v(){try{const e=JSON.parse(localStorage.getItem(d)||JSON.stringify(m)),t=JSON.parse(localStorage.getItem(u)||JSON.stringify(f)),n=JSON.parse(localStorage.getItem(p)||JSON.stringify(g)),{id:r,apiKey:o}=n;return{urls:e,recipients:t,payload:i(n,["id","apiKey"])}}catch(e){return{urls:m,recipients:f,payload:g}}}function b(){const{urls:e,recipients:t,payload:n}=v();document.getElementById("websocket-urls-list").innerHTML=e.map((e=>`<li>${e}</li>`)).join(""),document.getElementById("recipients-list").innerHTML=t.map((e=>`\n    <li>\n      <label>\n        <input type="checkbox" class="recipient-checkbox" data-pubkey="${e.pubkey}" checked>\n        ${e.name}\n      </label>\n    </li>\n  `)).join("");const r=document.getElementById("select-all-recipients"),o=document.querySelectorAll(".recipient-checkbox[data-pubkey]");r.addEventListener("change",(()=>{o.forEach((e=>{e.checked=r.checked}))})),o.forEach((e=>{e.addEventListener("change",(()=>{const e=Array.from(o).every((e=>e.checked));r.checked=e}))}));const s=document.getElementById("request-payload"),{id:c,apiKey:a}=n,l=i(n,["id","apiKey"]);s.value=JSON.stringify(l,null,2)}function h(){const{recipients:e}=v(),t=new Set(Array.from(document.querySelectorAll(".recipient-checkbox[data-pubkey]:checked")).map((e=>e.dataset.pubkey)));return e.filter((e=>t.has(e.pubkey)))}function k(){return s(this,void 0,void 0,(function*(){const{urls:e}=v(),{privateKeyRaw:t,publicKeyRaw:n}=yield(0,a.generateKey)();return l=new c.AcurastClient(e),yield l.start({secretKey:o.from(t).toString("hex"),publicKey:o.from(n).toString("hex")}),l}))}function E(e,t="pending"){const n=document.getElementById("results-container");let r=document.getElementById(`result-${e.pubkey}`);return r||(r=document.createElement("div"),r.id=`result-${e.pubkey}`,r.innerHTML=`\n      <h4>${e.name} ${e.isGateKeeper?"üîê":""}</h4>\n      <div class="content"></div>\n    `,n.appendChild(r)),r.className=`result-box ${t}`,r.querySelector(".content")}function S(e,t){const n=(new Date).toISOString();console.log(`[${n}] ${"outgoing"===e?"‚Üí":"‚Üê"} ${JSON.stringify(t,null,2)}`)}function O(){const e=document.querySelector(".loading-indicator");null==e||e.classList.add("active")}function w(){const e=document.querySelector(".loading-indicator");null==e||e.classList.remove("active")}function I(){return s(this,void 0,void 0,(function*(){const e=localStorage.getItem(y);if(!e)return;const t=h();if(0===t.length)return void alert("Please select at least one recipient");O();const n=document.getElementById("results-container"),r=document.getElementById("ping-results");r.querySelector("tbody"),n.style.display="none",r.style.display="table";const s=new Map,i=new Map;t.forEach((e=>{s.set(e.pubkey,{recipient:e,responseTime:0,status:"timeout",version:"pending..."})})),x(s);const c=new Map;try{l=yield k(),l.onMessage((e=>{var n;const r=o.from(e.payload).toString("utf8");try{const e=JSON.parse(r);S("incoming",e);const o=i.get(e.id),a=o?t.find((e=>e.pubkey===o)):null;if(a){const t=c.get(a.pubkey)||0,r=Date.now()-t;s.set(a.pubkey,{recipient:a,responseTime:r,version:null===(n=e.result)||void 0===n?void 0:n.version,status:"success"}),x(s)}}catch(e){console.error("Failed to parse message:",e)}}));for(const n of t){c.set(n.pubkey,Date.now());const t=Math.random().toString(36).substring(2,15);i.set(t,n.pubkey);const r={jsonrpc:"2.0",method:"ping",params:{},id:t,apiKey:e};S("outgoing",Object.assign(Object.assign({},r),{recipient:n.name}));try{yield l.send(n.pubkey.substring(2),o.from(JSON.stringify(r)).toString("hex"))}catch(e){s.set(n.pubkey,{recipient:n,responseTime:0,status:"timeout"}),x(s)}}setTimeout((()=>{for(const e of t){const t=s.get(e.pubkey);"success"!==(null==t?void 0:t.status)&&s.set(e.pubkey,{recipient:e,responseTime:0,status:"timeout"})}x(s),w()}),1e4)}catch(e){console.error("Error during ping:",e),r.style.display="none",n.style.display="block",n.innerHTML=`<div class="result-box error"><div class="content">Error: ${e instanceof Error?e.message:String(e)}</div></div>`,w()}}))}function x(e){const t=document.querySelector("#ping-results tbody"),n=Array.from(e.values()).sort(((e,t)=>"success"===e.status&&"success"!==t.status?-1:"success"!==e.status&&"success"===t.status||"timeout"===e.status&&"timeout"!==t.status?1:"timeout"!==e.status&&"timeout"===t.status?-1:e.responseTime-t.responseTime));t.innerHTML=n.map((e=>`\n    <tr class="${"timeout"===e.status?"timeout":""}">\n      <td>${"success"===e.status?"‚úÖ":"pending..."===e.version?"‚è≥":"‚ùå"} ${e.recipient.isGateKeeper?"üîê":""}</td>\n      <td>${"success"===e.status?`${e.responseTime}ms`:"pending..."===e.version?"waiting...":"timeout"}</td>\n      <td>${e.version||"-"}</td>\n      <td>${e.recipient.name}</td>\n    </tr>\n  `)).join("")}document.addEventListener("DOMContentLoaded",(()=>{var e,t;b(),function(){var e,t,n,r;const{urls:o,recipients:s}=v(),i=document.getElementById("urls-modal"),c=document.getElementById("urls-input");null===(e=document.getElementById("set-urls-btn"))||void 0===e||e.addEventListener("click",(()=>{c.value=JSON.stringify(o,null,2),i.showModal()})),null===(t=document.getElementById("urls-save"))||void 0===t||t.addEventListener("click",(()=>{try{const e=JSON.parse(c.value);if(!Array.isArray(e)||!e.every((e=>"string"==typeof e)))throw new Error("Invalid URLs format");localStorage.setItem(d,JSON.stringify(e)),b(),i.close()}catch(e){alert("Invalid JSON format for URLs")}}));const a=document.getElementById("recipients-modal"),l=document.getElementById("recipients-input");null===(n=document.getElementById("set-recipients-btn"))||void 0===n||n.addEventListener("click",(()=>{l.value=JSON.stringify(s,null,2),a.showModal()})),null===(r=document.getElementById("recipients-save"))||void 0===r||r.addEventListener("click",(()=>{try{const e=JSON.parse(l.value);if(!Array.isArray(e)||!e.every((e=>"object"==typeof e&&e.name&&e.pubkey&&"string"==typeof e.pubkey)))throw new Error("Invalid recipients format");localStorage.setItem(u,JSON.stringify(e)),b(),a.close()}catch(e){alert("Invalid JSON format for recipients")}}))}(),function(){const e=document.getElementById("request-payload");let t=null;e.addEventListener("input",(()=>{t&&window.clearTimeout(t),t=window.setTimeout((()=>{try{const t=JSON.parse(e.value);if("ping"!==t.method&&"checkNodes"!==t.method){const{id:e,apiKey:n}=t,r=i(t,["id","apiKey"]);localStorage.setItem(p,JSON.stringify(r))}}catch(e){}}),500)}))}(),function(){var e;const t=document.getElementById("api-key"),n=(document.getElementById("api-key-status"),t.closest(".input-with-status")),r=document.getElementById("api-key-set"),o=[document.getElementById("send-ping-btn"),document.getElementById("send-node-check-btn"),document.getElementById("connect-btn")];function s(e){n.style.display=e?"none":"flex",r.style.display=e?"block":"none",e?o.forEach((e=>null==e?void 0:e.removeAttribute("disabled"))):o.forEach((e=>null==e?void 0:e.setAttribute("disabled","true")))}const i=localStorage.getItem(y);i?(t.value=i,s(!0)):s(!1),t.addEventListener("input",(()=>{const e=t.value.trim();e&&(localStorage.setItem(y,e),s(!0))})),null===(e=document.getElementById("delete-api-key"))||void 0===e||e.addEventListener("click",(()=>{localStorage.removeItem(y),t.value="",s(!1)}))}(),null===(e=document.getElementById("send-ping-btn"))||void 0===e||e.addEventListener("click",I),null===(t=document.getElementById("send-node-check-btn"))||void 0===t||t.addEventListener("click",(()=>{var e;document.getElementById("request-payload").value=JSON.stringify({jsonrpc:"2.0",method:"checkNodes",params:{}},null,2),null===(e=document.getElementById("connect-btn"))||void 0===e||e.click()}))})),null===(r=document.getElementById("connect-btn"))||void 0===r||r.addEventListener("click",(()=>s(void 0,void 0,void 0,(function*(){const e=localStorage.getItem(y);if(e)try{const t=h();if(0===t.length)return void alert("Please select at least one recipient");O();const n=document.getElementById("results-container"),r=document.getElementById("ping-results");n.style.display="block",r.style.display="none",n.innerHTML="",l=yield k();const s=JSON.parse(document.getElementById("request-payload").value);s.apiKey=e;const i=new Map,c=new Map,d=new Set;for(const e of t){const t=E(e);t.textContent="Connecting...\n",i.set(e.pubkey,(e=>{t.textContent+=e+"\n"}));const n=setTimeout((()=>{if(!d.has(e.pubkey)){const t=document.getElementById(`result-${e.pubkey}`);if(t){E(e,"error");const n=t.querySelector(".content");n&&(n.textContent="Timeout: No response received after 10 seconds\n")}}w()}),1e4);c.set(e.pubkey,n)}l.onMessage((e=>{const n=o.from(e.payload).toString("utf8");try{const e=JSON.parse(n);S("incoming",e);const r=t.find((t=>t.pubkey===e.id));if(r){d.add(r.pubkey);const n=c.get(r.pubkey);n&&(clearTimeout(n),c.delete(r.pubkey));const o=E(r,e.error?"error":"success");if(o.innerHTML="","checkNodes"===s.method&&!e.error){const t=function(e,t){var n,r;const o=document.createElement("div");o.className="node-check-result";const s=document.createElement("table");s.className="ping-results";let i=`\n    <tr>\n      <td colspan="2"><strong>${e.name} ${e.isGateKeeper?"üîê":""}</strong></td>\n    </tr>\n  `;if(null===(n=t.result)||void 0===n?void 0:n.data.responses[0]){i+='<tr><td colspan="2"><strong>BTC</strong></td></tr>';const e=t.result.data.responses[0];"fulfilled"===e.status&&e.value?e.value.responses.forEach((e=>{"fulfilled"===e.status&&e.value?i+=`<tr><td style="padding-left: 20px">‚úÖ</td><td>${e.value.url}</td></tr>`:"rejected"===e.status&&e.reason&&(i+=`<tr class="timeout"><td style="padding-left: 20px">‚ùå</td><td>${e.reason.url}: ${e.reason.reason}</td></tr>`)})):"rejected"===e.status&&(i+=`<tr class="timeout"><td colspan="2" style="padding-left: 20px">Error: ${e.reason}</td></tr>`)}if(null===(r=t.result)||void 0===r?void 0:r.data.responses[1]){i+='<tr><td colspan="2"><strong>XTZ</strong></td></tr>';const e=t.result.data.responses[1];"fulfilled"===e.status&&e.value?e.value.responses.forEach((e=>{"fulfilled"===e.status&&e.value?i+=`<tr><td style="padding-left: 20px">‚úÖ</td><td>${e.value.url}</td></tr>`:"rejected"===e.status&&e.reason&&(i+=`<tr class="timeout"><td style="padding-left: 20px">‚ùå</td><td>${e.reason.url}: ${e.reason.reason}</td></tr>`)})):"rejected"===e.status&&(i+=`<tr class="timeout"><td colspan="2" style="padding-left: 20px">Error: ${e.reason}</td></tr>`)}return s.innerHTML=i,o.appendChild(s),o}(r,e);o.appendChild(t)}const i=document.createElement("pre");i.style.marginTop="20px",i.textContent=JSON.stringify(e,null,2),o.appendChild(i),d.size===t.length&&w()}}catch(e){console.error("Failed to parse message:",e)}}));for(const e of t){const t=yield(0,a.getSenderId)(e.pubkey),n=i.get(e.pubkey);n&&n(`Sending request (${t})...`);const r=Object.assign(Object.assign({},s),{id:e.pubkey});S("outgoing",Object.assign(Object.assign({},r),{recipient:e.name}));try{yield l.send(e.pubkey.substring(2),o.from(JSON.stringify(r)).toString("hex"))}catch(t){d.add(e.pubkey);const n=c.get(e.pubkey);n&&(clearTimeout(n),c.delete(e.pubkey)),E(e,"error").textContent=`Error: ${t instanceof Error?t.message:String(t)}`,w()}}window.addEventListener("beforeunload",(()=>{for(const e of c.values())clearTimeout(e);w()}))}catch(e){const t=h();for(const n of t)E(n,"error").textContent=`Error: ${e instanceof Error?e.message:String(e)}`;w()}}))))},8156:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),n(8986),o(n(3115),t)},9432:()=>{},3776:()=>{},9368:()=>{}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=t,e=[],r.O=(t,n,o,s)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,s]=e[d],c=!0,a=0;a<n.length;a++)(!1&s||i>=s)&&Object.keys(r.O).every((e=>r.O[e](n[a])))?n.splice(a--,1):(c=!1,s<i&&(i=s));if(c){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,o,s]},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={792:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,s,[i,c,a]=n,l=0;if(i.some((t=>0!==e[t]))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(a)var d=a(r)}for(t&&t(n);l<i.length;l++)s=i[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(d)},n=self.webpackChunkAcurastExample=self.webpackChunkAcurastExample||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[997,530,566,145],(()=>r(8156)));return r.O(o)})()));